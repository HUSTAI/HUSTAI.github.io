{"version":3,"file":"ArticleList.js","sourceRoot":"","sources":["../../../../../src/client/modules/blog/components/ArticleList.ts"],"names":[],"mappings":"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","sourcesContent":["import type { PropType, VNode } from \"vue\";\nimport { computed, defineComponent, h, onMounted, ref, watch } from \"vue\";\nimport { useRoute, useRouter } from \"vue-router\";\n\nimport DropTransition from \"@theme-hope/components/transitions/DropTransition\";\nimport ArticleItem from \"@theme-hope/modules/blog/components/ArticleItem\";\nimport Pagination from \"@theme-hope/modules/blog/components/Pagination\";\nimport { EmptyIcon } from \"@theme-hope/modules/blog/components/icons/index\";\nimport { useBlogOptions } from \"@theme-hope/modules/blog/composables/index\";\n\nimport type { ArticleInfo } from \"../../../../shared/index.js\";\n\nimport \"../styles/article-list.scss\";\n\ndeclare const SUPPORT_PAGEVIEW: boolean;\n\nexport default defineComponent({\n  name: \"ArticleList\",\n\n  props: {\n    /**\n     * Articles\n     *\n     * 文章项目\n     */\n    items: {\n      type: Array as PropType<{ path: string; info: ArticleInfo }[]>,\n      default: () => [],\n    },\n  },\n\n  setup(props) {\n    const route = useRoute();\n    const router = useRouter();\n\n    const blogOptions = useBlogOptions();\n\n    const currentPage = ref(1);\n\n    const articlePerPage = computed(\n      () => blogOptions.value.articlePerPage || 10\n    );\n\n    const currentArticles = computed(() =>\n      props.items.slice(\n        (currentPage.value - 1) * articlePerPage.value,\n        currentPage.value * articlePerPage.value\n      )\n    );\n\n    const updatePage = (page: number): void => {\n      currentPage.value = page;\n\n      const query = { ...route.query };\n\n      if (query[\"page\"] === page.toString() || (page === 1 && !query[\"page\"]))\n        return;\n      if (page === 1) delete query[\"page\"];\n      else query[\"page\"] = page.toString();\n\n      void router.push({ path: route.path, query });\n    };\n\n    onMounted(() => {\n      const { page } = route.query;\n\n      updatePage(page ? Number(page) : 1);\n\n      if (SUPPORT_PAGEVIEW)\n        void import(\n          /* webpackChunkName: \"pageview\" */ \"vuepress-plugin-comment2/pageview\"\n        ).then(({ updatePageview }) => {\n          updatePageview();\n        });\n\n      watch(currentPage, () => {\n        // list top border distance\n        const distance =\n          document.querySelector(\"#article-list\")!.getBoundingClientRect().top +\n          window.scrollY;\n\n        setTimeout(() => {\n          window.scrollTo(0, distance);\n        }, 100);\n      });\n\n      // FIXME: Workaround for https://github.com/vuepress/vuepress-next/issues/1249\n      watch(\n        () => route.query,\n        ({ page }) => {\n          updatePage(page ? Number(page) : 1);\n        }\n      );\n    });\n\n    return (): VNode =>\n      h(\n        \"div\",\n        { id: \"article-list\", class: \"vp-article-list\" },\n        currentArticles.value.length\n          ? [\n              ...currentArticles.value.map(({ info, path }, index) =>\n                h(DropTransition, { appear: true, delay: index * 0.04 }, () =>\n                  h(ArticleItem, { key: path, info, path })\n                )\n              ),\n              h(Pagination, {\n                current: currentPage.value,\n                perPage: articlePerPage.value,\n                total: props.items.length,\n                onUpdateCurrentPage: updatePage,\n              }),\n            ]\n          : h(EmptyIcon)\n      );\n  },\n});\n"]}