"use strict";const f=(t,r)=>{t.attrs=(t.attrs||[]).filter(([e])=>e!==r)},u=t=>{var r,e;const i=(e=(r=t.attrs)==null?void 0:r.find(([l])=>l==="title"))==null?void 0:e[1];return i?(f(t,"title"),i):t.content},d=(t,r={})=>{t.core.ruler.before("linkify","figure",e=>{for(let i=1,{length:l}=e.tokens;i<l-1;i++){const n=e.tokens[i];if(n.type!=="inline"||!n.children||n.children.length!==1&&n.children.length!==3||n.children.length===1&&n.children[0].type!=="image")continue;if(n.children.length===3){const[p,g,a]=n.children;if(p.type!=="link_open"||g.type!=="image"||a.type!=="link_close")continue}if(i!==0&&e.tokens[i-1].type!=="paragraph_open"||i!==l-1&&e.tokens[i+1].type!=="paragraph_close")continue;const o=e.tokens[i-1];o.type="figure_open",o.tag="figure",e.tokens[i+1].type="figure_close",e.tokens[i+1].tag="figure";const c=n.children.length===1?n.children[0]:n.children[1],s=u(c),[h]=t.parseInline(s,e.env);n.children.push(new e.Token("figcaption_open","figcaption",1)),n.children.push(...h.children||[]),n.children.push(new e.Token("figcaption_close","figcaption",-1)),r.focusable!==!1&&c.attrPush(["tabindex","0"])}})};exports.figure=d;
//# sourceMappingURL=index.cjs.map
