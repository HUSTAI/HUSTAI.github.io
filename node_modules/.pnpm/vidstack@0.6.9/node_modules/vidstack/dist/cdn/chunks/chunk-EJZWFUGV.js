import { o, u as u$1, za, s, r, aa, sa, E, g, P, H, p as p$1 } from './chunk-QIQY7YWJ.js';

var b=navigator?.userAgent.toLowerCase(),L=/iphone|ipad|ipod|ios|crios|fxios/i.test(b),oe=/(iphone|ipod)/gi.test(navigator?.platform),se=!!window.chrome,T=!!window.safari||L;function ue(){return !o(screen.orientation)&&u$1(screen.orientation.lock)&&u$1(screen.orientation.unlock)}function pe(i){return i||(i=document.createElement("video")),i.canPlayType("application/vnd.apple.mpegurl").length>0}function he(i){return !!document.pictureInPictureEnabled&&!i.disablePictureInPicture}function ce(i){return u$1(i.webkitSupportsPresentationMode)&&u$1(i.webkitSetPresentationMode)}async function le(){let i=document.createElement("video");return i.volume=.5,await za(0),i.volume===.5}function I(){return window?.MediaSource??window?.WebKitMediaSource}function V(){return window?.SourceBuffer??window?.WebKitSourceBuffer}function me(){let i=I();if(o(i))return !1;let e=i&&u$1(i.isTypeSupported)&&i.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),t=V(),r=o(t)||!o(t.prototype)&&u$1(t.prototype.appendBuffer)&&u$1(t.prototype.remove);return !!e&&!!r}var Ee=/\.(m4a|m4b|mp4a|mpga|mp2|mp2a|mp3|m2a|m3a|wav|weba|aac|oga|spx)($|\?)/i,fe=new Set(["audio/mpeg","audio/ogg","audio/3gp","audio/mp4","audio/webm","audio/flac"]),ge=/\.(mp4|og[gv]|webm|mov|m4v)(#t=[,\d+]+)?($|\?)/i,Se=new Set(["video/mp4","video/webm","video/3gp","video/ogg","video/avi","video/mpeg"]),D=/\.(m3u8)($|\?)/i,A=new Set(["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"]);function y({src:i,type:e}){return s(i)&&D.test(i)||A.has(e)}function R(i){return !o(window.MediaStream)&&i instanceof window.MediaStream}var d=class{constructor(e){this.it=e;}ar(){o(this.yt)&&this.ro();}tt(){r(this.yt)&&window.cancelAnimationFrame(this.yt),this.yt=void 0;}ro(){this.yt=window.requestAnimationFrame(()=>{o(this.yt)||(this.it(),this.ro());});}};function Re(i,e=2){return Number(i.toFixed(e))}function m(i){return String(i).split(".")[1]?.length??0}function ke(i,e,t){return Math.max(i,Math.min(t,e))}var u=class{constructor(e,t){this.ne=e;this.ee=t;this.We=sa();this.Ot=!1;this.io=!1;this.oo=!1;this.lr=new d(this.wn.bind(this));this.Yn=void 0;this.h6=void 0;this.Pn(),E(this.Vn.bind(this)),g(this.Ar.bind(this));}get _(){return this.ne.media}get ie(){return this.ee.delegate}Ar(){this.lr.tt(),this.We.empty();}wn(){let e=this.ne.currentTime;this.ee.$store.currentTime()!==e&&this.bt(e);}Pn(){this.he("loadstart",this.ot),this.he("abort",this.no),this.he("emptied",this.An),this.he("error",this.nt);}In(){this.io||(this.We.add(this.he("loadeddata",this.Rn),this.he("loadedmetadata",this.Hn),this.he("canplay",this.dr),this.he("canplaythrough",this.Dn),this.he("durationchange",this.On),this.he("play",this.Nn),this.he("progress",this.Fn),this.he("stalled",this.qn),this.he("suspend",this.Bn)),this.io=!0);}Zn(){this.oo||(this.We.add(this.he("pause",this.Gn),this.he("playing",this.Kn),this.he("ratechange",this.jn),this.he("seeked",this.Un),this.he("seeking",this.Qn),this.he("ended",this.Wn),this.he("volumechange",this.Ir),this.he("waiting",this.Xn)),this.oo=!0);}he(e,t){return P(this._,e,t.bind(this))}m6(e){}bt(e,t){this.ie.te("time-update",{detail:{currentTime:Math.min(e,this.ee.$store.seekableEnd()),played:this._.played},trigger:t});}ot(e){if(this._.networkState===3){this.no(e);return}this.In(),this.ie.te("load-start",{trigger:e});}no(e){this.ie.te("abort",{trigger:e});}An(){this.ie.te("emptied",{trigger:event});}Rn(e){this.ie.te("loaded-data",{trigger:e});}Hn(e){this.so(),this.Zn(),this.ie.te("volume-change",{detail:{volume:this._.volume,muted:this._.muted}}),this.ie.te("loaded-metadata",{trigger:e}),T&&y(this.ee.$store.source())&&this.ie.ao(this.Rr(),e);}Rr(){return {duration:this._.duration,buffered:this._.buffered,seekable:this._.seekable}}so(){let e=!Number.isFinite(this._.duration);this.ie.te("stream-type-change",{detail:e?"live":"on-demand"});}Nn(e){this.ee.$store.canPlay&&this.ie.te("play",{trigger:e});}Gn(e){this._.readyState===1&&!this.Ot||(this.Ot=!1,this.lr.tt(),this.ie.te("pause",{trigger:e}));}dr(e){this.ie.ao(this.Rr(),e);}Dn(e){this.ee.$store.started()||this.ie.te("can-play-through",{trigger:e,detail:this.Rr()});}Kn(e){this.Ot=!1,this.ie.te("playing",{trigger:e}),this.lr.ar();}qn(e){this.ie.te("stalled",{trigger:e}),this._.readyState<3&&(this.Ot=!0,this.ie.te("waiting",{trigger:e}));}Xn(e){this._.readyState<3&&(this.Ot=!0,this.ie.te("waiting",{trigger:e}));}Wn(e){this.lr.tt(),this.bt(this._.duration,e),this.ie.te("end",{trigger:e}),this.ee.$store.loop()?this.zn():this.ie.te("ended",{trigger:e});}Vn(){this.ee.$store.paused()&&P(this._,"timeupdate",this.Hr.bind(this));}Hr(e){this.bt(this._.currentTime,e);}On(e){this.so(),this.ee.$store.ended()&&this.bt(this._.duration,e),this.ie.te("duration-change",{detail:this._.duration,trigger:e});}Ir(e){this.ie.te("volume-change",{detail:{volume:this._.volume,muted:this._.muted},trigger:e});}Un(e){this.bt(this._.currentTime,e),this.ie.te("seeked",{detail:this._.currentTime,trigger:e}),Math.trunc(this._.currentTime)===Math.trunc(this._.duration)&&m(this._.duration)>m(this._.currentTime)&&(this.bt(this._.duration,e),this._.ended||this.ee.player.dispatchEvent(new H("media-play-request",{trigger:e})));}Qn(e){this.ie.te("seeking",{detail:this._.currentTime,trigger:e});}Fn(e){this.ie.te("progress",{detail:{buffered:this._.buffered,seekable:this._.seekable},trigger:e});}zn(){p$1(this._.controls)&&(this._.controls=!1),this.ee.player.dispatchEvent(new H("media-loop-request"));}Bn(e){this.ie.te("suspend",{trigger:e});}jn(e){this.ie.te("rate-change",{detail:this._.playbackRate,trigger:e});}nt(e){let t=this._.error;t&&this.ie.te("error",{detail:{message:t.message,code:t.code,mediaError:t},trigger:e});}};var k=Symbol(0),x=Symbol(0),Ne=Symbol(0),M=Symbol(0),Oe=Symbol(0),Ce=Symbol(0),Pe=Symbol(0),He=Symbol(0),Be=Symbol(0);var p=class{constructor(e,t){this.ne=e;this.ee=t;this.Nt.onaddtrack=this.Jn.bind(this),this.Nt.onremovetrack=this.es.bind(this),this.Nt.onchange=this.ts.bind(this),P(this.ee.audioTracks,"change",this.rs.bind(this));}get Nt(){return this.ne.media.audioTracks}Jn(e){let t=e.track;if(t.label==="")return;let r={id:t.id+"",label:t.label,language:t.language,kind:t.kind,selected:!1};this.ee.audioTracks[k](r,e),t.enabled&&(r.selected=!0);}es(e){let t=this.ee.audioTracks.getById(e.track.id);t&&this.ee.audioTracks[x](t,e);}ts(e){let t=this.lo();if(!t)return;let r=this.ee.audioTracks.getById(t.id);r&&this.ee.audioTracks[M](r,!0,e);}lo(){return Array.from(this.Nt).find(e=>e.enabled)}rs(e){let{current:t}=e.detail;if(!t)return;let r=this.Nt.getTrackById(t.id);if(r){let _=this.lo();_&&(_.enabled=!1),r.enabled=!0;}}};var w=class{constructor(e){this._=e;}setup(e){new u(this,e),"audioTracks"in this.media&&new p(this,e);}get type(){return ""}get media(){return this._}get paused(){return this._.paused}get muted(){return this._.muted}set muted(e){this._.muted=e;}get volume(){return this._.volume}set volume(e){this._.volume=e;}get currentTime(){return this._.currentTime}set currentTime(e){this._.currentTime=e;}get playsinline(){return this._.hasAttribute("playsinline")}set playsinline(e){aa(this._,"playsinline",e);}get playbackRate(){return this._.playbackRate}set playbackRate(e){this._.playbackRate=e;}async play(){return this._.play()}async pause(){return this._.pause()}async loadSource({src:e},t){this._.preload=t,R(e)?this._.srcObject=e:(this._.srcObject=null,this._.src=s(e)?e:window.URL.createObjectURL(e)),this._.load();}};

export { Pe as A, He as B, Be as C, w as D, oe as a, se as b, T as c, ue as d, pe as e, he as f, ce as g, le as h, me as i, Ee as j, fe as k, ge as l, Se as m, D as n, A as o, y as p, d as q, Re as r, m as s, ke as t, k as u, x as v, Ne as w, M as x, Oe as y, Ce as z };
