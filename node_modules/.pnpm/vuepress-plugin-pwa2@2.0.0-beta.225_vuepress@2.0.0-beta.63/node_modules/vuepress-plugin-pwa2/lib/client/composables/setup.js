import a from"mitt";import{provide as i,onMounted as n}from"vue";import{p as m}from"../usePWAEvent-f118b552.js";import{withBase as s}from"@vuepress/client";import{r as c,f as d}from"../registerSW-3f07adfb.js";const l=async t=>c(s(SW_PATH),{ready(e){t.emit("ready",e)},registered(e){t.emit("registered",e)},cached(e){t.emit("cached",e)},updatefound(e){t.emit("updatefound",e)},updated(e){const r="service-worker-version",o=Number(localStorage.getItem(r)||0);localStorage.setItem(r,(o+1).toString()),localStorage.removeItem("manifest"),t.emit("updated",e)},offline(){t.emit("offline")},error(e){t.emit("error",e)}}),f=()=>{if(__VUEPRESS_SSR__)return;const t=a();i(m,t),n(async()=>{var e;if(__VUEPRESS_DEV__)return;let r=!1;(e=navigator.serviceWorker)!=null&&e.controller&&navigator.serviceWorker.addEventListener("controllerchange",()=>{r||(r=!0,window.location.reload())}),SW_FORCE_UPDATE&&d(),await l(t)})};export{f as setupPWA};
//# sourceMappingURL=setup.js.map
