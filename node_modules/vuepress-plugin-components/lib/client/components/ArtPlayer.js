import{usePageLang as h}from"@vuepress/client";import{defineComponent as g,onMounted as w,onUnmounted as S,h as v,camelize as f}from"vue";import{keys as P}from"vuepress-shared/client";import"../styles/art-player.scss";import{u as b}from"../size-3452a743.js";import"@vuepress/shared";import"@vueuse/core";const E=["mp4","mp3","webm","ogg","m3u8","hls","ts","flv","mpd","dash"],T=e=>(e==null?void 0:e.split(".").pop())||"",M=async(e,a,r,s=!1,o=0)=>{const d=(await import("dashjs/dist/dash.all.min.js")).default;if(d.supportsMediaSource()){const i=d.MediaPlayer().create();i.initialize(e,a,s,o),r(()=>i.destroy())}},k=async(e,a,r)=>{const s=(await import("mpegts.js/dist/mpegts.js")).default;if(s.isSupported()){const o=s.createPlayer({type:"flv",url:a});o.attachMediaElement(e),o.load(),r(()=>o.destroy())}},z=async(e,a,r)=>{const s=(await import("hls.js/dist/hls.min.js")).default;if(e.canPlayType("application/x-mpegURL")||e.canPlayType("application/vnd.apple.mpegURL"))e.src=a;else if(s.isSupported()){const o=new s;o.attachMedia(e),o.on(s.Events.MEDIA_ATTACHED,function(){o.loadSource(a)}),r(()=>o.destroy())}},A=["no-fullscreen","no-hotkey","no-playback-rate","no-setting","no-mutex","no-plays-inline"],L=["airplay","autoplay","aspect-ratio","auto-mini","auto-size","auto-orientation","auto-playback","fast-forward","flip","fullscreen-web","lock","loop","is-live","muted","mini-progress-bar","pip","screenshot","subtitle-offset"],R=["en","pl","cs","es","fa","fr","id","ru"],_=["zh-cn","zh-tw"],D=e=>{const a=e.toLowerCase(),r=a.split("-")[0];return _.includes(a)?a:R.includes(r)?r:r==="zh"?"zh-cn":"en"};var N=g({name:"ArtPlayer",props:{src:{type:String,required:!0},type:{type:String,default:""},poster:{type:String,default:""},title:{type:String,default:""},width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:void 0},ratio:{type:[String,Number],default:16/9},config:{type:Object,default:null},customPlayer:{type:Function,default:e=>e}},setup(e,{attrs:a}){const r=h(),{el:s,width:o,height:d}=b(e,0);let i;const m=()=>{const t={theme:"#3eaf7c",...ART_PLAYER_OPTIONS,container:s.value,poster:e.poster,url:e.src,type:e.type||T(e.src),lang:D(r.value),...e.config,useSSR:!1},l=P(a);if(A.forEach(n=>{l.includes(n)&&(t[f(n.replace(/^no-/,""))]=!1)}),L.forEach(n=>{l.includes(n)&&(t[f(n)]=!0)}),t.type){const n=t.customType??={};if(E.includes(t.type.toLowerCase()))switch(t.type){case"m3u8":case"hls":n[t.type]??=(p,c,u)=>z(p,c,y=>{u.on("destroy",y)});break;case"flv":n[t.type]??=(p,c,u)=>k(p,c,y=>{u.on("destroy",y)});break;case"mpd":case"dash":n[t.type]??=(p,c,u)=>M(p,c,y=>{u.on("destroy",y)});break}else console.warn(`[components]: ArtPlayer does not support current file type ${t.type}!`)}return t};return w(async()=>{const{default:t}=await import("artplayer"),l=new t(m());i=await e.customPlayer(l)||l}),S(()=>{i==null||i.destroy()}),()=>v("div",{ref:s,class:"vp-artplayer",style:{width:o.value,height:d.value}},"Loading...")}});export{N as default};
//# sourceMappingURL=ArtPlayer.js.map
