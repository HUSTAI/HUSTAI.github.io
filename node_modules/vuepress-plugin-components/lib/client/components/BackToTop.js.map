{"version":3,"file":"BackToTop.js","sources":["../../../src/client/components/BackToTop.ts"],"sourcesContent":["import { usePageFrontmatter } from \"@vuepress/client\";\nimport { useElementSize, useWindowScroll, useWindowSize } from \"@vueuse/core\";\nimport type { VNode } from \"vue\";\nimport {\n  Transition,\n  computed,\n  defineComponent,\n  h,\n  onMounted,\n  shallowRef,\n} from \"vue\";\nimport { useLocaleConfig } from \"vuepress-shared/client\";\n\nimport { BackToTopIcon } from \"./icons.js\";\nimport type { BackToTopLocaleConfig } from \"../../shared/index.js\";\n\nimport \"balloon-css/balloon.css\";\nimport \"../styles/back-to-top.scss\";\n\ndeclare const BACK_TO_TOP_LOCALES: BackToTopLocaleConfig;\n\nexport default defineComponent({\n  name: \"BackToTop\",\n\n  props: {\n    /**\n     * Threshold distance in pixels to display the button\n     *\n     * 显示按钮的阈值距离，单位为像素\n     */\n    threshold: {\n      type: Number,\n      default: 100,\n    },\n\n    /**\n     * 是否隐藏浏览进度条\n     */\n    noProgress: Boolean,\n  },\n\n  setup(props) {\n    const pageFrontmatter = usePageFrontmatter<{ backToTop?: boolean }>();\n    const locale = useLocaleConfig(BACK_TO_TOP_LOCALES);\n    const body = shallowRef<HTMLBodyElement>();\n    const { height: bodyHeight } = useElementSize(body);\n    const { height: windowHeight } = useWindowSize();\n\n    /** Scroll distance */\n    const { y } = useWindowScroll();\n\n    /** Whether to display button */\n    const show = computed(\n      () =>\n        pageFrontmatter.value.backToTop !== false && y.value > props.threshold\n    );\n\n    const progress = computed(\n      () => y.value / (bodyHeight.value - windowHeight.value)\n    );\n\n    onMounted(() => {\n      body.value = <HTMLBodyElement>document.body;\n    });\n\n    return (): VNode =>\n      h(Transition, { name: \"fade\" }, () =>\n        show.value\n          ? h(\n              \"button\",\n              {\n                type: \"button\",\n                class: \"vp-back-to-top-button\",\n                // hint text\n                \"aria-label\": locale.value.backToTop,\n                \"data-balloon-pos\": \"left\",\n                // Scroll to top\n                onClick: () => {\n                  window.scrollTo({ top: 0, behavior: \"smooth\" });\n                },\n              },\n              [\n                props.noProgress\n                  ? null\n                  : h(\n                      \"svg\",\n                      { class: \"vp-scroll-progress\" },\n                      h(\"circle\", {\n                        cx: \"50%\",\n                        cy: \"50%\",\n                        style: {\n                          \"stroke-dasharray\": `calc(${\n                            Math.PI * progress.value * 100\n                          }% - ${4 * Math.PI}px) calc(${Math.PI * 100}% - ${\n                            4 * Math.PI\n                          }px)`,\n                        },\n                      })\n                    ),\n                h(BackToTopIcon),\n              ]\n            )\n          : null\n      );\n  },\n});\n"],"names":["BackToTop","defineComponent","props","pageFrontmatter","usePageFrontmatter","locale","useLocaleConfig","body","shallowRef","bodyHeight","useElementSize","windowHeight","useWindowSize","y","useWindowScroll","show","computed","progress","onMounted","h","Transition","BackToTopIcon"],"mappings":"2ZAqBA,IAAAA,EAAeC,EAAgB,CAC7B,KAAM,YAEN,MAAO,CAML,UAAW,CACT,KAAM,OACN,QAAS,GACX,EAKA,WAAY,OACd,EAEA,MAAMC,EAAO,CACX,MAAMC,EAAkBC,EAClBC,EAAAA,EAASC,EAAgB,mBAAmB,EAC5CC,EAAOC,EAA4B,EACnC,CAAE,OAAQC,CAAW,EAAIC,EAAeH,CAAI,EAC5C,CAAE,OAAQI,CAAa,EAAIC,IAG3B,CAAE,EAAAC,CAAE,EAAIC,IAGRC,EAAOC,EACX,IACEb,EAAgB,MAAM,YAAc,IAASU,EAAE,MAAQX,EAAM,SACjE,EAEMe,EAAWD,EACf,IAAMH,EAAE,OAASJ,EAAW,MAAQE,EAAa,MACnD,EAEA,OAAAO,EAAU,IAAM,CACdX,EAAK,MAAyB,SAAS,IACzC,CAAC,EAEM,IACLY,EAAEC,EAAY,CAAE,KAAM,MAAO,EAAG,IAC9BL,EAAK,MACDI,EACE,SACA,CACE,KAAM,SACN,MAAO,wBAEP,aAAcd,EAAO,MAAM,UAC3B,mBAAoB,OAEpB,QAAS,IAAM,CACb,OAAO,SAAS,CAAE,IAAK,EAAG,SAAU,QAAS,CAAC,CAChD,CACF,EACA,CACEH,EAAM,WACF,KACAiB,EACE,MACA,CAAE,MAAO,oBAAqB,EAC9BA,EAAE,SAAU,CACV,GAAI,MACJ,GAAI,MACJ,MAAO,CACL,mBAAoB,QAClB,KAAK,GAAKF,EAAS,MAAQ,UACtB,EAAI,KAAK,cAAc,KAAK,GAAK,UACtC,EAAI,KAAK,OAEb,CACF,CAAC,CACH,EACJE,EAAEE,CAAa,CACjB,CACF,EACA,IACN,CACJ,CACF,CAAC"}