{"version":3,"file":"BiliBili.js","sources":["../../../src/client/components/BiliBili.ts"],"sourcesContent":["/* eslint-disable vue/no-unused-properties */\nimport type { VNode } from \"vue\";\nimport { computed, defineComponent, h, ref } from \"vue\";\nimport { LoadingIcon } from \"vuepress-shared/client\";\n\nimport { useSize } from \"../composables/index.js\";\nimport { videoIframeAllow } from \"../utils/index.js\";\n\nimport \"../styles/bili-bili.scss\";\n\nconst VIDEO_LINK = \"https://player.bilibili.com/player.html\";\n\nexport default defineComponent({\n  name: \"BiliBili\",\n\n  props: {\n    /**\n     * BiliBili video id\n     *\n     * B 站视频 ID\n     */\n    bvid: {\n      type: String,\n      default: \"\",\n    },\n\n    /**\n     * BiliBili video aid\n     *\n     * B 站视频 a ID\n     */\n    aid: {\n      type: String,\n      default: \"\",\n    },\n\n    /**\n     * BiliBili video cid\n     *\n     * B 站视频 CID\n     */\n    cid: {\n      type: String,\n      default: \"\",\n    },\n\n    /**\n     * BiliBili video title\n     *\n     * B 站视频标题\n     */\n    title: {\n      type: String,\n      default: \"A BiliBili video\",\n    },\n\n    /**\n     * BiliBili video page\n     *\n     * B 站视频分页\n     */\n    page: {\n      type: [String, Number],\n      default: 1,\n    },\n\n    /**\n     * Component width\n     *\n     * 组件宽度\n     */\n    width: {\n      type: [String, Number],\n      default: \"100%\",\n    },\n\n    /**\n     * Component height\n     *\n     * 组件高度\n     */\n    height: {\n      type: [String, Number],\n      default: undefined,\n    },\n\n    /**\n     * Component width / height ratio\n     *\n     * 组件长宽比\n     */\n    ratio: {\n      type: [String, Number],\n      default: 16 / 9,\n    },\n\n    /**\n     * Start time in seconds\n     *\n     * 基于秒数的开始时间\n     */\n    time: {\n      type: [String, Number],\n      default: 0,\n    },\n\n    /**\n     * Whether autoplay\n     *\n     * 是否自动播放\n     */\n    autoplay: Boolean,\n  },\n\n  setup(props) {\n    const { el, width, height } = useSize<HTMLIFrameElement>(props);\n\n    const loaded = ref(false);\n\n    const videoLink = computed(() => {\n      const { aid, bvid, cid, autoplay, time, page } = props;\n\n      return aid && cid\n        ? `${VIDEO_LINK}?aid=${aid}&cid=${cid}&t=${time}&autoplay=${\n            autoplay ? 1 : 0\n          }&page=${page}`\n        : bvid\n        ? `${VIDEO_LINK}?bvid=${bvid}&t=${time}&autoplay=${autoplay ? 1 : 0}`\n        : null;\n    });\n\n    return (): (VNode | null)[] =>\n      videoLink.value\n        ? [\n            h(\n              \"div\",\n              { class: \"bilibili-desc\" },\n              h(\"a\", { class: \"sr-only\", href: videoLink.value }, props.title)\n            ),\n            h(\"iframe\", {\n              ref: el,\n              // Tip: `https://www.bilibili.com/blackboard/newplayer.html?bvid=${props.bvid}&as_wide=1&page=1` only support whitelist sites now\n              src: videoLink.value,\n              title: props.title,\n              class: \"bilibili-iframe\",\n              allow: videoIframeAllow,\n              style: {\n                width: width.value,\n                height: loaded.value ? height.value : 0,\n              },\n              onLoad: () => {\n                loaded.value = true;\n              },\n            }),\n            loaded.value ? null : h(LoadingIcon),\n          ]\n        : [];\n  },\n});\n"],"names":["VIDEO_LINK","defineComponent","props","el","width","height","useSize","loaded","ref","videoLink","computed","aid","bvid","cid","autoplay","time","page","h","videoIframeAllow","LoadingIcon"],"mappings":"+RAUA,MAAMA,EAAa,0CAEnB,MAAeC,EAAgB,CAC7B,KAAM,WAEN,MAAO,CAML,KAAM,CACJ,KAAM,OACN,QAAS,EACX,EAOA,IAAK,CACH,KAAM,OACN,QAAS,EACX,EAOA,IAAK,CACH,KAAM,OACN,QAAS,EACX,EAOA,MAAO,CACL,KAAM,OACN,QAAS,kBACX,EAOA,KAAM,CACJ,KAAM,CAAC,OAAQ,MAAM,EACrB,QAAS,CACX,EAOA,MAAO,CACL,KAAM,CAAC,OAAQ,MAAM,EACrB,QAAS,MACX,EAOA,OAAQ,CACN,KAAM,CAAC,OAAQ,MAAM,EACrB,QAAS,MACX,EAOA,MAAO,CACL,KAAM,CAAC,OAAQ,MAAM,EACrB,QAAS,GAAK,CAChB,EAOA,KAAM,CACJ,KAAM,CAAC,OAAQ,MAAM,EACrB,QAAS,CACX,EAOA,SAAU,OACZ,EAEA,MAAMC,EAAO,CACX,KAAM,CAAE,GAAAC,EAAI,MAAAC,EAAO,OAAAC,CAAO,EAAIC,EAA2BJ,CAAK,EAExDK,EAASC,EAAI,EAAK,EAElBC,EAAYC,EAAS,IAAM,CAC/B,KAAM,CAAE,IAAAC,EAAK,KAAAC,EAAM,IAAAC,EAAK,SAAAC,EAAU,KAAAC,EAAM,KAAAC,CAAK,EAAId,EAEjD,OAAOS,GAAOE,EACV,GAAGb,SAAkBW,SAAWE,OAASE,cACvCD,EAAW,EAAI,UACRE,IACTJ,EACA,GAAGZ,UAAmBY,OAAUG,cAAiBD,EAAW,EAAI,IAChE,IACN,CAAC,EAED,MAAO,IACLL,EAAU,MACN,CACEQ,EACE,MACA,CAAE,MAAO,eAAgB,EACzBA,EAAE,IAAK,CAAE,MAAO,UAAW,KAAMR,EAAU,KAAM,EAAGP,EAAM,KAAK,CACjE,EACAe,EAAE,SAAU,CACV,IAAKd,EAEL,IAAKM,EAAU,MACf,MAAOP,EAAM,MACb,MAAO,kBACP,MAAOgB,EACP,MAAO,CACL,MAAOd,EAAM,MACb,OAAQG,EAAO,MAAQF,EAAO,MAAQ,CACxC,EACA,OAAQ,IAAM,CACZE,EAAO,MAAQ,EACjB,CACF,CAAC,EACDA,EAAO,MAAQ,KAAOU,EAAEE,CAAW,CACrC,EACA,CAAA,CACR,CACF,CAAC"}