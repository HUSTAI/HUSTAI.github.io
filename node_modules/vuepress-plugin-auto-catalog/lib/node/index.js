import{useSassPalettePlugin as K}from"vuepress-plugin-sass-palette";import{Logger as $,ensureEndingSlash as C,getTitleFromFilename as E,checkVersion as T,getLocales as _}from"vuepress-shared/node";import{createPage as L}from"@vuepress/core";import{getDirname as v,path as M,colors as s}from"@vuepress/utils";const G=v(import.meta.url),y="vuepress-plugin-auto-catalog",f=new $(y),I=C(M.resolve(G,"../client")),w=({pages:e},{component:a,iconGetter:o,iconRouteMetaKey:l="icon",shouldIndex:r,indexRouteMetaKey:g="index",orderGetter:i,orderRouteMetaKey:p="order",titleGetter:c=t=>t.title,titleRouteMetaKey:m="title"})=>{a||e.forEach(t=>{const d={},n=c==null?void 0:c(t),u=o==null?void 0:o(t),h=(r==null?void 0:r(t))??null,A=(i==null?void 0:i(t))??null;n&&(d[m]=n),u&&(d[l]=u),typeof h=="boolean"&&(d[g]=h?1:0),typeof A=="number"&&(d[p]=A),t.routeMeta={...t.routeMeta,...d}})},x=async(e,{component:a="AutoCatalog",exclude:o=[],frontmatter:l=()=>({}),level:r=3,index:g=!1})=>{const{env:{isDebug:i},pages:p}=e,c=new Set,m=`<${a}${[1,2].includes(r)?` :level="${r}"`:""}${g?" index":""}/>
`;p.forEach(({path:t,pathLocale:d})=>{let n=t;if(t!=="/404.html")for(;n!==d;)n=n.replace(/\/(?:[^/]+\/?)$/,"/"),!c.has(n)&&o.every(u=>!n.match(u))&&p.every(({path:u})=>u!==n)&&(i&&f.info(`Generating catalog ${n}}`),c.add(n))}),await Promise.all(Array.from(c).map(t=>decodeURI(t)).map(t=>{const[,d=""]=/\/([^/]+)\/?$/.exec(t)||[],n=E(d);return L(e,{frontmatter:{title:n,...l(t)||{}},content:m,path:t})})).then(t=>{e.pages.push(...t)})},O=({options:e,deprecatedOption:a,newOption:o,msg:l="",scope:r=""})=>{if(a in e){if(f.warn(`${s.magenta(a)} is ${s.yellow("deprecated")}${r?` in ${r}`:""}, please use "${s.magenta(o)}" instead.${l?`
${l}`:""}`),o.includes(".")){const g=o.split(".");let i=e;g.forEach((p,c)=>{c!==g.length-1?(i[p]=i[p]||{},i=i[p]):i[p]=e[a]})}else e[o]=e[a];delete e[a]}},R=(e,a,o="",l="")=>{a in e&&(f.error(`"${s.magenta(a)}" is ${s.red("removed")}${l?`, please use ${s.magenta(l)} instead.`:" and no longer supported"}${o?`
${o}`:""}`),l||delete e[a])},k=e=>{O({options:e,deprecatedOption:"getTitle",newOption:"titleGetter"}),O({options:e,deprecatedOption:"getIcon",newOption:"iconGetter"}),O({options:e,deprecatedOption:"getOrder",newOption:"orderGetter"}),O({options:e,deprecatedOption:"getIndex",newOption:"shouldIndex"}),R(e,"iconComponent",`please use ${s.magenta("defineAutoCatalogIconComponent")} in client config file.`)},D={"/en/":{title:"Catalog",empty:"No catalog"},"/zh/":{title:"目录",empty:"暂无目录"},"/zh-tw/":{title:"目錄",empty:"暫無目錄"},"/de/":{title:"Katalog",empty:"Kein Katalog"},"/de-at/":{title:"Katalog",empty:"Kein Katalog"},"/vi/":{title:"Danh mục",empty:"Không có danh mục"},"/uk/":{title:"Каталог",empty:"Немає каталогу"},"/ru/":{title:"Каталог",empty:"Нет каталога"},"/br/":{title:"Catálogo",empty:"Sem catálogo"},"/pl/":{title:"Katalog",empty:"Brak katalogu"},"/sk/":{title:"Katalóg",empty:"Žiadny katalóg"},"/fr/":{title:"Catalogue",empty:"Pas de catalogue"},"/es/":{title:"Catálogo",empty:"Sin catálogo"},"/ja/":{title:"カタログ",empty:"カタログなし"},"/tr/":{title:"Katalog",empty:"Katalog yok"},"/ko/":{title:"목차",empty:"목차 없음"},"/fi/":{title:"Luettelo",empty:"Ei luetteloa"},"/hu/":{title:"Katalógus",empty:"Nincs katalógus"},"/id/":{title:"Katalog",empty:"Tidak ada katalog"},"/nl/":{title:"Catalogus",empty:"Geen catalogus"}},N=(e={},a=!0)=>o=>{a&&k(e),T(o,y,"2.0.0-beta.63"),o.env.isDebug&&f.info("Options:",e),K(o,{id:"hope"});const{component:l,iconRouteMetaKey:r="icon",indexRouteMetaKey:g="index",locales:i,orderRouteMetaKey:p="order",titleRouteMetaKey:c="title"}=e;return{name:y,define:()=>({AUTO_CATALOG_LOCALES:_({app:o,name:y,default:D,config:i}),AUTO_CATALOG_TITLE_META_KEY:c,AUTO_CATALOG_ICON_META_KEY:r,AUTO_CATALOG_ORDER_META_KEY:p,AUTO_CATALOG_INDEX_META_KEY:g}),onInitialized:async m=>{w(m,e),await x(m,e)},...l?{}:{clientConfigFile:`${I}config.js`}}};export{N as autoCatalogPlugin};
//# sourceMappingURL=index.js.map
