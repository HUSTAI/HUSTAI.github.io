import { D, g as g$1, f as f$1, e } from './chunk-YECGPXDM.js';
import { n, xa, s, O, H, r, g as g$2, P } from './chunk-QIQY7YWJ.js';

var R=Symbol(0),M=Symbol(0),d=Symbol(0),p=Symbol(0),w=Symbol(0),b=Symbol(0),T=Symbol(0),K=Symbol(0);function z(n$1,r="preconnect"){let e=document.querySelector(`link[href="${n$1}"]`);if(!n(e))return !0;let t=document.createElement("link");return t.rel=r,t.href=n$1,t.crossOrigin="true",document.head.append(t),!0}var f={};function B(n$1){if(f[n$1])return f[n$1].promise;let r=xa(),e=document.querySelector(`script[src="${n$1}"]`);if(!n(e))return r.resolve(),r.promise;let t=document.createElement("script");return t.src=n$1,t.onload=()=>{r.resolve(),delete f[n$1];},t.onerror=()=>{r.reject(),delete f[n$1];},setTimeout(()=>document.head.append(t),0),r.promise}function L(n){return n==="use-credentials"?"include":s(n)?"same-origin":void 0}function Z(n,r){for(let e=0,t=r.length;e<t;e++)if(v(r[e],n))return r[e];return null}function v(n,r){return r>=n.startTime&&r<n.endTime}function ee(n,r,e){let t=n.toArray().find(i=>i.kind==="chapters"&&i.mode==="showing");if(t!==r){if(!t){e(null);return}t.readyState==2?e(t):(e(null),t.addEventListener("load",()=>e(t),{once:!0}));}}var U,G,$,_=class extends O{constructor(e){super();this.id="";this.label="";this.language="";this.default=!1;this.xt=!1;this.Tt=0;this.Me="disabled";this.co={};this.cr=[];this.xe=[];this.Mt=[];this[U]=0;this[G]=null;this[$]=null;for(let t of Object.keys(e))this[t]=e[t];e.content?import('./prod-YUKGQJCA.js').then(({parseText:t,VTTCue:i,VTTRegion:s})=>{e.type==="json"?this.po(e.content,i,s):t(e.content,{type:e.type}).then(({cues:a,regions:o})=>{this.xe=a,this.cr=o,this.ho();});}):e.src||(this[d]=2);}static createId(e){return `id::${e.type}-${e.kind}-${e.src??e.label}`}get metadata(){return this.co}get regions(){return this.cr}get cues(){return this.xe}get activeCues(){return this.Mt}get readyState(){return this[d]}get mode(){return this.Me}set mode(e){this.setMode(e);}addCue(e,t){let i=0,s=this.xe.length;for(i=0;i<s&&!(e.endTime<=this.xe[i].startTime);i++);i===s?this.xe.push(e):this.xe.splice(i,0,e),t?.type!=="cuechange"&&this[T]?.track.addCue(e),this.dispatchEvent(new H("add-cue",{detail:e,trigger:t})),v(e,this.Tt)&&this[p](this.Tt,t);}removeCue(e,t){let i=this.xe.indexOf(e);if(i>=0){let s=this.Mt.includes(e);this.xe.splice(i,1),this[T]?.track.removeCue(e),this.dispatchEvent(new H("remove-cue",{detail:e,trigger:t})),s&&this[p](this.Tt,t);}}setMode(e,t){this.Me!==e&&(this.Me=e,e==="disabled"?(this.Mt=[],this.mo()):this.readyState===2?this[p](this.Tt,t):this.fo(),this.dispatchEvent(new H("mode-change",{detail:this,trigger:t})),this[b]?.());}[(U=d,G=b,$=T,p)](e,t){if(this.Tt=e,this.mode==="disabled"||!this.xe.length)return;let i=[];for(let a=0,o=this.xe.length;a<o;a++){let u=this.xe[a];v(u,e)&&i.push(u);}let s=i.length!==this.Mt.length;if(!s){for(let a=0;a<i.length;a++)if(!this.Mt.includes(i[a])){s=!0;break}}this.Mt=i,s&&this.mo(t);}[w](){this.xt=!0,this.Me!=="disabled"&&this.fo();}async fo(){if(!(!this.xt||!this.src||this[d]>0)){this[d]=1,this.dispatchEvent(new H("load-start"));try{let{parseResponse:e,VTTCue:t,VTTRegion:i}=await import('./prod-YUKGQJCA.js'),s=this[M]?.(),a=fetch(this.src,{headers:this.type==="json"?{"Content-Type":"application/json"}:void 0,credentials:L(s)});if(this.type==="json")this.po(await(await a).text(),t,i);else {let{errors:o,metadata:u,regions:H,cues:X}=await e(a,{type:this.type,encoding:this.encoding});if(o[0]?.code===0)throw o[0];this.co=u,this.cr=H,this.xe=X;}this.ho();}catch(e){this.Co(e);}}}ho(){this[d]=2;let e=this[T]?.track;if(e)for(let i of this.xe)e.addCue(i);let t=new H("load");this[p](this.Tt,t),this.dispatchEvent(t);}Co(e){this[d]=3,this.dispatchEvent(new H("error",{detail:e}));}po(e,t,i){try{e=JSON.parse(e),e.regions&&(this.cr=e.regions.map(s=>Object.assign(new i,s))),e.cues&&(this.xe=e.cues.filter(s=>r(s.startTime)&&r(s.endTime)).map(s=>Object.assign(new t(0,0,""),s)));}catch(s){this.Co(s);}}mo(e){this.dispatchEvent(new H("cue-change",{trigger:e}));}},F=/captions|subtitles/;function ae(n){return F.test(n.kind)}var x=class{constructor(r,e){this.se=r;this.ee=e;r.textTracks.onaddtrack=this.Or.bind(this),g$2(this.Ir.bind(this));}Or(r){let e=r.track;if(!e||q(this.se,e))return;let t=new _({id:e.id,kind:e.kind,label:e.label,language:e.language,type:"vtt"});t[T]={track:e},t[d]=2,t[K]=!0;let i=0,s=a=>{if(e.cues)for(let o=i;o<e.cues.length;o++)t.addCue(e.cues[o],a),i++;};s(r),e.oncuechange=s,this.ee.textTracks.add(t,r),t.setMode(e.mode,r);}Ir(){this.se.textTracks.onaddtrack=null;for(let r of this.ee.textTracks){let e=r[T]?.track;e?.oncuechange&&(e.oncuechange=null);}}};function q(n,r){return Array.from(n.children).find(e=>e.track===r)}var C=class{constructor(r,e){this.se=r;this._=e;this.ue=(r,e)=>{this._.delegate.re("picture-in-picture-change",{detail:r,trigger:e});};P(this.se,"enterpictureinpicture",this.as.bind(this)),P(this.se,"leavepictureinpicture",this.ls.bind(this));}get active(){return document.pictureInPictureElement===this.se}get supported(){return f$1(this.se)}async enter(){return this.se.requestPictureInPicture()}exit(){return document.exitPictureInPicture()}as(r){this.ue(!0,r);}ls(r){this.ue(!1,r);}};var g=class{constructor(r,e){this.se=r;this._=e;this.Me="inline";P(this.se,"webkitpresentationmodechanged",this.ds.bind(this));}get go(){return g$1(this.se)}async pr(r){this.Me!==r&&this.se.webkitSetPresentationMode(r);}ds(){let r=this.Me;this.Me=this.se.webkitPresentationMode,this._.player?.dispatchEvent(new H("video-presentation-change",{detail:this.Me,trigger:event})),["fullscreen","picture-in-picture"].forEach(e=>{(this.Me===e||r===e)&&this._.delegate.re(`${e}-change`,{detail:this.Me===e,trigger:event});});}},k=class{constructor(r){this.qe=r;}get active(){return this.qe.Me==="fullscreen"}get supported(){return this.qe.go}async enter(){this.qe.pr("fullscreen");}async exit(){this.qe.pr("inline");}},y=class{constructor(r){this.qe=r;}get active(){return this.qe.Me==="picture-in-picture"}get supported(){return this.qe.go}async enter(){this.qe.pr("picture-in-picture");}async exit(){this.qe.pr("inline");}};var j=Symbol(0),Y,N=class extends D{constructor(e,t){super(e);this[Y]=!0;if(g$1(e)){let i=new g(e,t);this.fullscreen=new k(i),this.pictureInPicture=new y(i);}else f$1(e)&&(this.pictureInPicture=new C(e,t));}get type(){return "video"}setup(e$1){super.setup(e$1),e(this.video)&&new x(this.video,e$1),e$1.textRenderers[R](this.video),g$2(()=>{e$1.textRenderers[R](null);}),this.type==="video"&&e$1.delegate.re("provider-setup",{detail:this});}get video(){return this._}};Y=j;

export { z as a, B as b, L as c, R as d, M as e, d as f, p as g, w as h, b as i, T as j, K as k, Z as l, v as m, ee as n, _ as o, ae as p, j as q, N as r };
