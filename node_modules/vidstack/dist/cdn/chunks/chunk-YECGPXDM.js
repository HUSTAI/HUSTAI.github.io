import { o, u as u$1, za, s, r, aa, sa, E, g, P, H, p as p$1 } from './chunk-QIQY7YWJ.js';

var b=navigator?.userAgent.toLowerCase(),L=/iphone|ipad|ipod|ios|crios|fxios/i.test(b),oe=/(iphone|ipod)/gi.test(navigator?.platform),se=!!window.chrome,T=!!window.safari||L;function ue(){return !o(screen.orientation)&&u$1(screen.orientation.lock)&&u$1(screen.orientation.unlock)}function pe(i){return i||(i=document.createElement("video")),i.canPlayType("application/vnd.apple.mpegurl").length>0}function he(i){return !!document.pictureInPictureEnabled&&!i.disablePictureInPicture}function ce(i){return u$1(i.webkitSupportsPresentationMode)&&u$1(i.webkitSetPresentationMode)}async function le(){let i=document.createElement("video");return i.volume=.5,await za(0),i.volume===.5}function I(){return window?.MediaSource??window?.WebKitMediaSource}function V(){return window?.SourceBuffer??window?.WebKitSourceBuffer}function me(){let i=I();if(o(i))return !1;let e=i&&u$1(i.isTypeSupported)&&i.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),t=V(),r=o(t)||!o(t.prototype)&&u$1(t.prototype.appendBuffer)&&u$1(t.prototype.remove);return !!e&&!!r}var Ee=/\.(m4a|m4b|mp4a|mpga|mp2|mp2a|mp3|m2a|m3a|wav|weba|aac|oga|spx)($|\?)/i,fe=new Set(["audio/mpeg","audio/ogg","audio/3gp","audio/mp4","audio/webm","audio/flac"]),ge=/\.(mp4|og[gv]|webm|mov|m4v)(#t=[,\d+]+)?($|\?)/i,Se=new Set(["video/mp4","video/webm","video/3gp","video/ogg","video/avi","video/mpeg"]),D=/\.(m3u8)($|\?)/i,A=new Set(["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"]);function y({src:i,type:e}){return s(i)&&D.test(i)||A.has(e)}function R(i){return !o(window.MediaStream)&&i instanceof window.MediaStream}var d=class{constructor(e){this.it=e;}lr(){o(this.yt)&&this.ro();}tt(){r(this.yt)&&window.cancelAnimationFrame(this.yt),this.yt=void 0;}ro(){this.yt=window.requestAnimationFrame(()=>{o(this.yt)||(this.it(),this.ro());});}};function Re(i,e=2){return Number(i.toFixed(e))}function m(i){return String(i).split(".")[1]?.length??0}function ke(i,e,t){return Math.max(i,Math.min(t,e))}var u=class{constructor(e,t){this.ne=e;this.ee=t;this.We=sa();this.Ft=!1;this.io=!1;this.oo=!1;this.dr=new d(this.An.bind(this));this.es=void 0;this.g6=void 0;this.In(),E(this.Rn.bind(this)),g(this.Ir.bind(this));}get _(){return this.ne.media}get te(){return this.ee.delegate}Ir(){this.dr.tt(),this.We.empty();}An(){let e=this.ne.currentTime;this.ee.$store.currentTime()!==e&&this.bt(e);}In(){this.me("loadstart",this.ot),this.me("abort",this.no),this.me("emptied",this.Hn),this.me("error",this.nt);}Dn(){this.io||(this.We.add(this.me("loadeddata",this.On),this.me("loadedmetadata",this.Nn),this.me("canplay",this.ur),this.me("canplaythrough",this.Fn),this.me("durationchange",this.qn),this.me("play",this.Bn),this.me("progress",this.Zn),this.me("stalled",this.Gn),this.me("suspend",this.Kn)),this.io=!0);}jn(){this.oo||(this.We.add(this.me("pause",this.Un),this.me("playing",this.Qn),this.me("ratechange",this.Wn),this.me("seeked",this.Xn),this.me("seeking",this.Yn),this.me("ended",this.zn),this.me("volumechange",this.Rr),this.me("waiting",this.Jn)),this.oo=!0);}me(e,t){return P(this._,e,t.bind(this))}v6(e){}bt(e,t){this.te.re("time-update",{detail:{currentTime:Math.min(e,this.ee.$store.seekableEnd()),played:this._.played},trigger:t});}ot(e){if(this._.networkState===3){this.no(e);return}this.Dn(),this.te.re("load-start",{trigger:e});}no(e){this.te.re("abort",{trigger:e});}Hn(){this.te.re("emptied",{trigger:event});}On(e){this.te.re("loaded-data",{trigger:e});}Nn(e){this.so(),this.jn(),this.te.re("volume-change",{detail:{volume:this._.volume,muted:this._.muted}}),this.te.re("loaded-metadata",{trigger:e}),T&&y(this.ee.$store.source())&&this.te.ao(this.Hr(),e);}Hr(){return {duration:this._.duration,buffered:this._.buffered,seekable:this._.seekable}}so(){let e=!Number.isFinite(this._.duration);this.te.re("stream-type-change",{detail:e?"live":"on-demand"});}Bn(e){this.ee.$store.canPlay&&this.te.re("play",{trigger:e});}Un(e){this._.readyState===1&&!this.Ft||(this.Ft=!1,this.dr.tt(),this.te.re("pause",{trigger:e}));}ur(e){this.te.ao(this.Hr(),e);}Fn(e){this.ee.$store.started()||this.te.re("can-play-through",{trigger:e,detail:this.Hr()});}Qn(e){this.Ft=!1,this.te.re("playing",{trigger:e}),this.dr.lr();}Gn(e){this.te.re("stalled",{trigger:e}),this._.readyState<3&&(this.Ft=!0,this.te.re("waiting",{trigger:e}));}Jn(e){this._.readyState<3&&(this.Ft=!0,this.te.re("waiting",{trigger:e}));}zn(e){this.dr.tt(),this.bt(this._.duration,e),this.te.re("end",{trigger:e}),this.ee.$store.loop()?this.ts():this.te.re("ended",{trigger:e});}Rn(){this.ee.$store.paused()&&P(this._,"timeupdate",this.Dr.bind(this));}Dr(e){this.bt(this._.currentTime,e);}qn(e){this.so(),this.ee.$store.ended()&&this.bt(this._.duration,e),this.te.re("duration-change",{detail:this._.duration,trigger:e});}Rr(e){this.te.re("volume-change",{detail:{volume:this._.volume,muted:this._.muted},trigger:e});}Xn(e){this.bt(this._.currentTime,e),this.te.re("seeked",{detail:this._.currentTime,trigger:e}),Math.trunc(this._.currentTime)===Math.trunc(this._.duration)&&m(this._.duration)>m(this._.currentTime)&&(this.bt(this._.duration,e),this._.ended||this.ee.player.dispatchEvent(new H("media-play-request",{trigger:e})));}Yn(e){this.te.re("seeking",{detail:this._.currentTime,trigger:e});}Zn(e){this.te.re("progress",{detail:{buffered:this._.buffered,seekable:this._.seekable},trigger:e});}ts(){p$1(this._.controls)&&(this._.controls=!1),this.ee.player.dispatchEvent(new H("media-loop-request"));}Kn(e){this.te.re("suspend",{trigger:e});}Wn(e){this.te.re("rate-change",{detail:this._.playbackRate,trigger:e});}nt(e){let t=this._.error;t&&this.te.re("error",{detail:{message:t.message,code:t.code,mediaError:t},trigger:e});}};var k=Symbol(0),x=Symbol(0),Ne=Symbol(0),M=Symbol(0),Oe=Symbol(0),Ce=Symbol(0),Pe=Symbol(0),He=Symbol(0),Be=Symbol(0);var p=class{constructor(e,t){this.ne=e;this.ee=t;this.qt.onaddtrack=this.rs.bind(this),this.qt.onremovetrack=this.is.bind(this),this.qt.onchange=this.os.bind(this),P(this.ee.audioTracks,"change",this.ns.bind(this));}get qt(){return this.ne.media.audioTracks}rs(e){let t=e.track;if(t.label==="")return;let r={id:t.id+"",label:t.label,language:t.language,kind:t.kind,selected:!1};this.ee.audioTracks[k](r,e),t.enabled&&(r.selected=!0);}is(e){let t=this.ee.audioTracks.getById(e.track.id);t&&this.ee.audioTracks[x](t,e);}os(e){let t=this.lo();if(!t)return;let r=this.ee.audioTracks.getById(t.id);r&&this.ee.audioTracks[M](r,!0,e);}lo(){return Array.from(this.qt).find(e=>e.enabled)}ns(e){let{current:t}=e.detail;if(!t)return;let r=this.qt.getTrackById(t.id);if(r){let _=this.lo();_&&(_.enabled=!1),r.enabled=!0;}}};var w=class{constructor(e){this._=e;}setup(e){new u(this,e),"audioTracks"in this.media&&new p(this,e);}get type(){return ""}get media(){return this._}get paused(){return this._.paused}get muted(){return this._.muted}set muted(e){this._.muted=e;}get volume(){return this._.volume}set volume(e){this._.volume=e;}get currentTime(){return this._.currentTime}set currentTime(e){this._.currentTime=e;}get playsinline(){return this._.hasAttribute("playsinline")}set playsinline(e){aa(this._,"playsinline",e);}get playbackRate(){return this._.playbackRate}set playbackRate(e){this._.playbackRate=e;}async play(){return this._.play()}async pause(){return this._.pause()}async loadSource({src:e},t){this._.preload=t,R(e)?this._.srcObject=e:(this._.srcObject=null,this._.src=s(e)?e:window.URL.createObjectURL(e)),this._.load();}};

export { Pe as A, He as B, Be as C, w as D, oe as a, se as b, T as c, ue as d, pe as e, he as f, ce as g, le as h, me as i, Ee as j, fe as k, ge as l, Se as m, D as n, A as o, y as p, d as q, Re as r, m as s, ke as t, k as u, x as v, Ne as w, M as x, Oe as y, Ce as z };
